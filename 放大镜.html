<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="css/bigimg.css" rel="stylesheet" />  
    <title>放大镜</title>
</head>

<body>
    <html lang="en"></html>
<head>
  <meta charset="UTF-8">
  <title>放大镜</title>
  <link href="css/bigimg.css"/>
</head>
<body onload="bigimg()">
  <div id="box">
    <img src="img/14.jpg" alt="#" style="width: 330px; height:330px">
    <div id="move"></div>
    <div id="bimg">
      <img id="b_bimg" src="img/14.jpg" alt="#">
    </div>
  </div>
</body>
<script>
function bigimg(){
  let bbox = document.getElementById("box");
  let bmove = document.getElementById("move");
  let bbimg = document.getElementById("bimg");
  let b_bimg = document.getElementById("b_bimg");
  bbox.onmouseover = function(){//鼠标移动到box上显示大图片和选框
    bbimg.style.display = "block";
    bmove.style.display="block";
  }
  bbox.onmouseout = function(){//鼠标移开box不显示大图片和选框
    bbimg.style.display = "none";
    bmove.style.display="none";
  }
  bbox.onmousemove = function(e){//获取鼠标位置
    let x = e.clientX;//鼠标相对于视口的位置
    let y = e.clientY;
    let t = bbox.offsetTop;//box相对于视口的位置
    let l = bbox.offsetLeft;
    let _left = x - l - bmove.offsetWidth/2;//计算move的位置
    let _top = y - t -bmove.offsetHeight/2;
    if(_top<=0)//滑到box的最顶部
      _top = 0;
    else if(_top>=bbox.offsetHeight-bmove.offsetHeight)//滑到box的最底部
      _top = bbox.offsetHeight-bmove.offsetHeight ;
    if(_left<=0)//滑到box的最左边
      _left=0;
    else if(_left>=bbox.offsetWidth-bmove.offsetWidth)//滑到box的最右边
      _left=bbox.offsetWidth-bmove.offsetWidth ;
    bmove.style.top = _top +"px";//设置move的位置
    bmove.style.left = _left + "px";
   let  w = _left/(bbox.offsetWidth-bmove.offsetWidth);//计算移动的比例
   let h = _top/(bbox.offsetHeight-bmove.offsetHeight);
   let b_bimg_top = (b_bimg.offsetHeight-bbimg.offsetHeight)*h;//计算大图的位置
   let b_bimg_left = (b_bimg.offsetWidth-bbimg.offsetWidth)*w;
    b_bimg.style.top = -b_bimg_top + "px";//设置大图的位置信息
    b_bimg.style.left = -b_bimg_left + "px";
  }
     
}

</script>

</html>